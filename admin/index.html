<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1000 Home Vibes Admin Panel</title>
  <style>
    /* ...existing styles above... */
    /* (kept unchanged) */

    /* --- New Product Wisdom Styles --- */
    #wisdoms .product-card {border:2px solid #00ffd5;}
    .wisdom-section {margin-top:40px;}
  </style>
</head>
<body>
  <div class="main">
    <h1>📦 Product Manager – 1000HomeVibes</h1>

    <div class="nav">
      <a href="index.html">📦 Product Manager</a>
      <a href="analytics.html">📊 View Analytics</a>
    </div>

    <div id="controls">
      <button onclick="loadFromGit()">Reload from GitHub</button>
      <button onclick="addProduct()">+ Add Product</button>
      <button onclick="saveToGit()">💾 Save to GitHub</button>
      <button onclick="autoGenerateProducts()">🤖 Auto AI</button>
    </div>

    <div id="products"></div>
    <pre id="status"></pre>

    <!-- 🔹 New Wisdom Section -->
    <div class="wisdom-section">
      <h2 style="color:gold;text-align:center;">✨ Product Wisdom Manager</h2>
      <button onclick="loadWisdom()">Reload Wisdom</button>
      <button onclick="addWisdom()">+ Add Wisdom</button>
      <button onclick="saveWisdom()">💾 Save Wisdom</button>
      <div id="wisdoms"></div>
      <pre id="wisdomStatus"></pre>
    </div>
  </div>

  <div class="sidebar">
    <!-- ...existing sidebar unchanged... -->
    <h2>📅 Tools</h2>
    <div class="widget">
      <h3>Calendar</h3>
      <iframe src="https://calendar.google.com/calendar/embed?showTitle=0&mode=MONTH&height=200" height="200"></iframe>
    </div>
    <div class="widget">
      <h3>Clock</h3>
      <div id="clock" style="font-size:1.2em;font-weight:bold;"></div>
    </div>
  </div>

  <!-- Existing Edit Modal (unchanged) -->
  <!-- ... -->

  <!-- 🔹 New Wisdom Modal -->
  <div id="wisdomModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeWisdomModal()">&times;</span>
      <h2>Edit Product Wisdom</h2>

      <label>Product ID</label>
      <input id="wisdomId">

      <label>Wellness Hook</label>
      <textarea id="wisdomHook" rows="2"></textarea>

      <label>How to Use</label>
      <textarea id="wisdomHow" rows="2"></textarea>

      <label>Bonus Tip</label>
      <textarea id="wisdomBonus" rows="2"></textarea>

      <label>Good For (Audience)</label>
      <textarea id="wisdomGood" rows="2"></textarea>

      <label>Extra Image 1</label>
      <input id="wisdomImage1">
      <label>Extra Image 2</label>
      <input id="wisdomImage2">
      <label>Video URL</label>
      <input id="wisdomVideo">

      <button onclick="saveWisdomEdit()">Save Wisdom Changes</button>
    </div>
  </div>

  <script>
    // Clock
    setInterval(() => {
      const d = new Date();
      document.getElementById('clock').textContent = d.toLocaleTimeString();
    }, 1000);

    const API_BASE = 'https://one000homevibes.onrender.com';
    const ADMIN_SECRET = '';
    let products = [];
    let editingIndex = null;

    // Wisdom arrays
    let wisdoms = [];
    let editingWisdomIndex = null;

    // ------- EXISTING PRODUCT FUNCTIONS (kept) -------
    // ...all your existing JS exactly as before...

    // ------- NEW PRODUCT WISDOM FUNCTIONS -------

    function renderWisdom() {
      const container = document.getElementById('wisdoms');
      container.innerHTML = '';
      wisdoms.forEach((w,i)=>{
        const div = document.createElement('div');
        div.className='product-card';
        div.innerHTML=`
          <div class="product-info">
            <strong>${w.id || '(No id)'}</strong><br>
            <small>${w.wellness_hook||''}</small>
          </div>
          <div>
            <button onclick="openWisdomModal(${i})">✏️ Edit</button>
            <button onclick="removeWisdom(${i})">❌ Delete</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function openWisdomModal(i){
      editingWisdomIndex=i;
      const w=wisdoms[i];
      document.getElementById('wisdomId').value=w.id||'';
      document.getElementById('wisdomHook').value=w.wellness_hook||'';
      document.getElementById('wisdomHow').value=w.how_to_use||'';
      document.getElementById('wisdomBonus').value=w.bonus_tip||'';
      document.getElementById('wisdomGood').value=w.good_for||'';
      document.getElementById('wisdomImage1').value=w.image1||'';
      document.getElementById('wisdomImage2').value=w.image2||'';
      document.getElementById('wisdomVideo').value=w.video||'';
      document.getElementById('wisdomModal').style.display='flex';
    }

    function closeWisdomModal(){
      document.getElementById('wisdomModal').style.display='none';
      editingWisdomIndex=null;
    }

    function saveWisdomEdit(){
      if(editingWisdomIndex===null)return;
      const w=wisdoms[editingWisdomIndex];
      w.id=document.getElementById('wisdomId').value;
      w.wellness_hook=document.getElementById('wisdomHook').value;
      w.how_to_use=document.getElementById('wisdomHow').value;
      w.bonus_tip=document.getElementById('wisdomBonus').value;
      w.good_for=document.getElementById('wisdomGood').value;
      w.image1=document.getElementById('wisdomImage1').value;
      w.image2=document.getElementById('wisdomImage2').value;
      w.video=document.getElementById('wisdomVideo').value;
      renderWisdom();
      closeWisdomModal();
    }

    function addWisdom(){
      wisdoms.push({
        id:'', wellness_hook:'',how_to_use:'',bonus_tip:'',
        good_for:'',image1:'',image2:'',video:''
      });
      renderWisdom();
    }

    function removeWisdom(i){wisdoms.splice(i,1);renderWisdom();}

    async function loadWisdom(){
      document.getElementById('wisdomStatus').textContent='Loading Wisdom...';
      try{
        const res=await fetch(API_BASE+'/product-wisdom');
        const data=await res.json();
        wisdoms=data||[];
        renderWisdom();
        document.getElementById('wisdomStatus').textContent='Loaded ✅';
      }catch(e){
        document.getElementById('wisdomStatus').textContent='Error loading ❌';
        console.error(e);
      }
    }

    async function saveWisdom(){
      const secret=ADMIN_SECRET||prompt('Enter Admin Secret:');
      document.getElementById('wisdomStatus').textContent='Saving Wisdom...';
      try{
        const res=await fetch(API_BASE+'/update-product-wisdom',{
          method:'POST',
          headers:{'Content-Type':'application/json','x-admin-secret':secret},
          body:JSON.stringify(wisdoms)
        });
        if(!res.ok)throw new Error('Save failed');
        await loadWisdom();
        document.getElementById('wisdomStatus').textContent='Saved ✅ and reloaded';
      }catch(e){
        document.getElementById('wisdomStatus').textContent='Error saving ❌';
        console.error(e);
      }
    }

    window.addEventListener('DOMContentLoaded',()=>{
      loadFromGit();
      loadWisdom();
    });
  </script>
</body>
</html>
